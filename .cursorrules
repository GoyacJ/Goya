# Goya 项目 Cursor 规则

## 项目简介
Goya 是一个企业级开发框架，采用前后端分离架构：
- **Goya/**: Java 后端框架（Spring Boot 4.0.1 + Java 25）
- **goya-web-ui/**: Vue 3 前端管理系统（TypeScript + Vite + pnpm Monorepo）

## 核心技术栈

### 后端
- Java 25 + Spring Boot 4.0.1 + Spring Cloud 2025.1.0
- MyBatis Plus 3.5.15 + MySQL/PostgreSQL
- Spring AI 2.0.0-M1 + LangChain4j 1.9.1
- Nacos 3.1.1 + Redisson 4.0.0
- MapStruct 1.6.3 + Lombok 1.18.42

### 前端 (goya-web-ui/)
- Vue 3.5.24 + TypeScript + Vite
- pnpm 10.x + Turborepo (Monorepo)
- 多UI框架：Ant Design Vue / Element Plus / Naive UI
- Pinia + VueRouter + Tailwind CSS

## 代码规范

### Java 命名
- 包名：`com.ysmjjsy.goya.{module}.{layer}`
- 属性：**camelCase**（禁止下划线）
- 常量接口：`I*Constants`
- 枚举：`*Enum`
- 异常：`*Exception`
- 配置类：`*AutoConfiguration`

### Java 必须使用的注解
```java
@Slf4j                          // 日志（必须）
@RequiredArgsConstructor        // 构造器注入
@Transactional(rollbackFor = Exception.class)  // 事务
```

### Java 日志格式
```java
log.debug("[Goya] |- component [xxx] XxxAutoConfiguration auto configure.");
log.trace("[Goya] |- component [xxx] |- bean [xxxService] register.");
```

### Java 注释规范
- 所有注释使用**中文**
- 类注释：功能描述 + 使用示例 + @author goya + @since 日期 + @see
- 方法注释：功能描述 + @param + @return + @throws
- 参考官方文档时注明链接

### TypeScript/Vue 规范
- 优先使用 `<script setup>` 语法
- Store 使用 Setup 风格 (`defineStore('name', () => { ... })`)
- API 函数命名：`xxxApi()` (如 `loginApi`, `getUserInfoApi`)
- Store 命名：`use*Store` (如 `useAuthStore`)

## 项目结构

### 后端模块（v0.4.0）
```
Goya/
├── bom/                       # 版本管理 BOM
├── component/                 # 公共组件
│   ├── component-framework/   # 框架基础（聚合模块）
│   │   ├── framework-core/    # 核心工具类
│   │   ├── framework-common/  # 公共组件
│   │   ├── framework-masker/  # 数据脱敏
│   │   ├── framework-crypto/  # 加密解密
│   │   ├── framework-cache/   # 缓存抽象
│   │   ├── framework-bus/     # 消息总线抽象
│   │   ├── framework-log/     # 日志增强
│   │   ├── framework-oss/     # OSS 抽象
│   │   ├── framework-servlet/ # Servlet 增强
│   │   └── framework-boot-starter/ # 自动配置
│   ├── component-redis/       # Redis 实现（分布式锁/布隆过滤器/延迟队列）
│   ├── component-kafka/       # Kafka 消息
│   ├── component-rabbitmq/    # RabbitMQ 消息
│   ├── component-mybatisplus/ # MyBatis Plus 增强
│   ├── component-captcha/     # 验证码
│   ├── component-security/    # 安全模块（4子模块）
│   ├── component-social/      # 社交登录
│   ├── component-oss-aliyun/  # 阿里云 OSS
│   ├── component-oss-s3/      # AWS S3
│   └── component-oss-minio/   # MinIO
├── ai/                        # AI模块（mcp, model, rag, spring, video）
├── platform/                  # 平台（monolith单体, distributed分布式）
├── cloud/                     # 云原生支持
├── deploy/                    # 部署配置（docker, maven）
└── docs/                      # 项目文档
```

### 前端结构
```
goya-web-ui/
├── apps/            # 应用（web-antd, web-ele, web-naive, backend-mock）
├── packages/        # 共享包（@core, effects, stores, types, utils...）
└── internal/        # 内部工具（lint-configs, vite-config, tsconfig...）
```

## 设计模式
- **Builder 模式**：复杂对象构建（Response, SecurityUser）
- **策略模式**：IStrategy + StrategyChoose
- **责任链模式**：IChainHandler + ChainContext

## 响应格式
```json
{
  "code": "0200",
  "message": "操作成功",
  "isSuccess": true,
  "timestamp": "2025-12-21 00:00:00",
  "data": {},
  "traceId": "xxx",
  "path": "/api/xxx"
}
```

## MCP 工具使用
- **context7**: 查询官方框架文档（Spring Boot, Vue, TypeScript等）

## AI 助手开发规范

**重要**：AI 助手（Cursor AI）在开发时必须遵循以下规范：

### 开发前准备（必须完成）
1. **必须**阅读 `README.md`（项目主文档）了解项目概况
2. **必须**查阅项目文档体系（架构文档、开发指南、API 参考）
3. **必须**查阅开发进度和变更历史（changelog.md、milestones.md）
4. **必须**激活相关 Cursor Rules 和 Skills
5. **必须**理解相关模块的代码实现和设计模式

**AI 助手必须激活的 Rules**：
- `.cursor/rules/ai-assistant-guide.mdc` - AI 助手开发规范（**必须**）
- `.cursor/rules/development-workflow.mdc` - 开发工作流规范
- `.cursor/rules/pre-development-checklist.mdc` - 开发前检查清单

**AI 助手必须使用的 Skills**：
- `goya-development-workflow` - 开发工作流助手（**必须**）

### 开发过程
1. 严格遵循 `.cursorrules` 和 `.cursor/rules/*.mdc` 中的代码规范
2. 使用正确的 API（ApiRes 而非 Response、CacheService 而非 ICache）
3. 使用相关 Skills 辅助开发
4. 遵循项目文档中的设计模式和最佳实践
5. 所有注释使用中文，日志格式：`log.debug("[Goya] |- ...")`

### 开发后工作（必须完成）
1. **必须**更新 `docs/progress/changelog.md`
2. **必须**更新相关模块的进度文档（如有）
3. **必须**更新项目文档（如需要）
4. **必须**生成规范的 Git 提交信息
5. **必须**提醒用户提交代码

详细工作流请参考：
- `.cursor/AI_ASSISTANT_GUIDE.md` - AI 助手使用指南（**AI 助手必读**）
- `.cursor/rules/ai-assistant-guide.mdc` - AI 助手开发规范
- `.cursor/rules/development-workflow.mdc` - 开发工作流规范
- `.cursor/rules/pre-development-checklist.mdc` - 开发前检查清单
- `.cursor/rules/post-development-checklist.mdc` - 开发后检查清单

## 详细规范
完整规范请参考：`.cursor/rules/` 目录下的规则文件

