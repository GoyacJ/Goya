package com.ysmjjsy.goya.component.cache.enums;

/**
 * 缓存一致性等级
 *
 * <p>定义多级缓存的一致性保证语义，允许业务代码根据场景选择合适的一致性等级。
 * 不同等级在写入策略、同步等待、失败处理等方面有不同的行为。
 *
 * <p><b>设计目的：</b>
 * <ul>
 *   <li>显式暴露一致性语义，避免业务代码对缓存行为的误解</li>
 *   <li>支持不同业务场景的一致性需求（强一致性、最终一致性、尽力而为）</li>
 *   <li>为未来的一致性优化提供扩展点</li>
 * </ul>
 *
 * @author goya
 * @since 2025/12/26
 */
public enum ConsistencyLevel {

    /**
     * 强一致性
     *
     * <p>要求 L2 写入成功 + L1 写入成功，确保当前节点的 L1 和 L2 缓存一致。
     * 适用于对数据一致性要求极高的场景，如金融交易、库存扣减等。
     *
     * <p><b>行为：</b>
     * <ul>
     *   <li>L2 写入失败时，不写入 L1，抛出异常</li>
     *   <li>L1 写入失败时，回滚 L2（如果可能），抛出异常</li>
     *   <li>不等待跨节点同步（跨节点同步通过事件机制异步完成）</li>
     * </ul>
     *
     * <p><b>注意：</b>此等级仅保证当前节点的 L1 和 L2 缓存一致，不保证跨节点立即一致。
     * 跨节点一致性通过事件机制异步保证。
     */
    STRONG,

    /**
     * 最终一致性（默认）
     *
     * <p>要求 L2 写入成功，L1 和跨节点同步异步执行。
     * 适用于大多数业务场景，如用户信息、配置数据等。
     *
     * <p><b>行为：</b>
     * <ul>
     *   <li>L2 写入成功即可返回，不等待 L1 和跨节点同步</li>
     *   <li>L2 写入失败时，根据降级策略处理（可能降级到 L1）</li>
     *   <li>L1 写入失败时，记录日志但不影响主流程</li>
     * </ul>
     */
    EVENTUAL
}

